
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_DataWrapperUsage.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_DataWrapperUsage.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_DataWrapperUsage.py:


.. _data-wrap-ex:

Examples Using the Main Data Wrappers from crispy
=================================================

.. GENERATED FROM PYTHON SOURCE LINES 9-12

Here, we provide a brief introduction on how to use the main data structures
defined in ``crispy.crisp``. Specifically, these examples will cover the
``CRISP``, ``CRISPNonU``, and ``CRISPWideband`` structures.

.. GENERATED FROM PYTHON SOURCE LINES 12-17

.. code-block:: default


    from crispy import CRISP, CRISPWideband, CRISPNonU
    import warnings
    warnings.filterwarnings("ignore")








.. GENERATED FROM PYTHON SOURCE LINES 18-26

CRISP
-----
To demonstrate the CRISP class we use an example of a CRISP observation from
the M1.1 solar flare SOL20140906T17:09 observed by SST/CRISP in
H:math:`\alpha` and Ca II 8542. The data is publicly avaiable through the
F-CHROMA project `here
<https://star.pst.qub.ac.uk/wiki/doku.php/public/solarflares/start>`_. Below
we show the data for H :math:`\alpha`.

.. GENERATED FROM PYTHON SOURCE LINES 26-30

.. code-block:: default


    crisp = CRISP("example_data/2014/crisp_l2_20140906_152724_6563_r00447.fits")
    print(crisp)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


            CRISP Observation
            ------------------
            2014-09-06 16:53:39.174

            Observed: H I 6563
            Centre wavelength [Å]: 6564.58
            Wavelengths sampled: 15
            Pointing [arcsec] (HPLN, HPLT): (-730.032, -313.398)
            Shape: [15, 1398, 1473]




.. GENERATED FROM PYTHON SOURCE LINES 31-35

The data structures use slicing derived from astropy's `NDData
<https://docs.astropy.org/en/stable/nddata/>`_ meaning the objects can be
directly sliced to produce new objects of just the slice e.g. for only looking
at the far blue wing data in our observation

.. GENERATED FROM PYTHON SOURCE LINES 35-38

.. code-block:: default


    print(crisp[0])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


            CRISP Observation
            ------------------
            2014-09-06 16:53:39.174

            Observed: H I 6563
            Centre wavelength [Å]: 6564.58
            Wavelengths sampled: 15
            Pointing [arcsec] (HPLN, HPLT): (-730.032, -313.398)
            Shape: [1398, 1473]




.. GENERATED FROM PYTHON SOURCE LINES 39-43

This is also the easiest way to use the plotting methods. For this
observation, to view an image at a specific wavelength we would use the
``intensity_map`` instance method as shown below for the line core of the
H :math:`\alpha` observation

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default


    crisp[7].intensity_map()




.. image-sg:: /auto_examples/images/sphx_glr_plot_DataWrapperUsage_001.png
   :alt: 2014-09-06T16:53:39.174 λ=6564.58Å (Δλ = -0.0Å)
   :srcset: /auto_examples/images/sphx_glr_plot_DataWrapperUsage_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 47-51

We can then use slicing and the ``plot_spectrum`` instance method to plot the
spectrum at a certain spatial point. Firstly though to identify the slice we
need we use the ``from_lonlat`` instance method, in this example we take the
point :math:`(-720'', -310'')` in the Helioprojective plane:

.. GENERATED FROM PYTHON SOURCE LINES 53-61

.. note:: 
  There are complimentary instance methods ``from_lonlat`` and
  ``to_lonlat`` which convert coordinates to/from the Helioprojective frame.
  The format of the Helioprojective coordinates are **always** given in the
  format (longitude, latitude) while image plane coordinates are **always**
  given in (y,x) pixels. This is to allow the direct indexing of the objects
  via the image plane corrdinates while maintaining the Helioprojective (and
  other physical coordinate systems) convention of (longitude, latitude).

.. GENERATED FROM PYTHON SOURCE LINES 61-65

.. code-block:: default


    y, x = crisp.from_lonlat(-720, -310)
    print(y,x)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    759 912




.. GENERATED FROM PYTHON SOURCE LINES 67-68

.. code-block:: default


    crisp[:,y,x].plot_spectrum()


.. image-sg:: /auto_examples/images/sphx_glr_plot_DataWrapperUsage_002.png
   :alt: 2014-09-06T16:53:39.174 H I 6563Å
   :srcset: /auto_examples/images/sphx_glr_plot_DataWrapperUsage_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.024 seconds)


.. _sphx_glr_download_auto_examples_plot_DataWrapperUsage.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_DataWrapperUsage.py <plot_DataWrapperUsage.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_DataWrapperUsage.ipynb <plot_DataWrapperUsage.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
